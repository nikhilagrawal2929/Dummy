private static String convertToDualCase(String input) {
    String[] words = input.split(" ");
    StringBuilder result = new StringBuilder();

    for (String word : words) {
        if (word.startsWith("O'")) {
            result.append("O'").append(Character.toUpperCase(word.charAt(2))).append(word.substring(3).toLowerCase());
        } else if (word.startsWith("MC")) {
            result.append("Mc").append(Character.toUpperCase(word.charAt(2))).append(word.substring(3).toLowerCase());
        } else if (word.startsWith("MAC") && word.length() > 3 && word.charAt(3) != 'h') {
            result.append("Mac").append(Character.toUpperCase(word.charAt(3))).append(word.substring(4).toLowerCase());
        } else {
            result.append(Character.toUpperCase(word.charAt(0))).append(word.substring(1).toLowerCase());
        }
        result.append(" ");
    }

    // Remove trailing space
    return result.toString().trim();
}
